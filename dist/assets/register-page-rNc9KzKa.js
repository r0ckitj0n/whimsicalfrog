console.log("[Page] register-page.js loaded");function I(e){document.readyState!=="loading"?e():document.addEventListener("DOMContentLoaded",e,{once:!0})}I(()=>{const e=document.getElementById("registerForm");e&&e.addEventListener("submit",async d=>{d.preventDefault();const c=document.getElementById("registerUsername")?.value,l=document.getElementById("registerEmail")?.value,m=document.getElementById("registerPassword")?.value,g=document.getElementById("registerFirstName")?.value,u=document.getElementById("registerLastName")?.value,y=document.getElementById("registerPhone")?.value,f=document.getElementById("registerAddress1")?.value,h=document.getElementById("registerAddress2")?.value,E=document.getElementById("registerCity")?.value,p=document.getElementById("registerState")?.value,v=document.getElementById("registerZipCode")?.value,n=document.getElementById("registerErrorMessage"),t=document.getElementById("registerSuccessMessage");n&&n.classList.add("hidden"),t&&t.classList.add("hidden");function o(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768}const B="/process_register.php";try{const r=await fetch(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:c,email:l,password:m,firstName:g,lastName:u,phoneNumber:y,addressLine1:f,addressLine2:h,city:E,state:p,zipCode:v})}),s=await r.json();if(!r.ok)throw new Error(s.error||"Registration failed");if(s.success&&s.autoLogin&&s.userData){sessionStorage.setItem("user",JSON.stringify(s.userData));const i=o()?"/?page=shop":"/?page=room_main",a=o()?"shop":"main room";e&&(e.style.display="none"),t&&(t.innerHTML=`
            <strong>Welcome ${s.userData.firstName||s.userData.username}!</strong><br>
            Registration successful! Redirecting you to the ${a} in 5 seconds...<br><br>
            <a href="${i}" class="inline-block bg-[#6B8E23] hover:bg-[#556B2F] text-black font-bold rounded-md focus:outline-none focus:shadow-outline transition duration-150">
              Go to ${a} now â†’
            </a>
          `,t.classList.remove("hidden")),setTimeout(()=>{window.location.href=i},5e3)}else t&&t.classList.remove("hidden");e.reset()}catch(r){n?(n.textContent=r.message,n.classList.remove("hidden")):console.error("[RegisterPage] Error:",r)}})});
