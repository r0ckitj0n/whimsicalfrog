<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart Options Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .product { border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .product img { width: 100px; height: 100px; object-fit: cover; }
        button { background: #87ac3a; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #6b8c2a; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 500px; border-radius: 8px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: black; }
        .quantity-controls { margin: 20px 0; }
        .quantity-controls input { width: 60px; text-align: center; margin: 0 10px; }
        .hidden { display: none; }
        .cart-display { position: fixed; top: 20px; right: 20px; background: #f0f0f0; padding: 15px; border-radius: 8px; min-width: 200px; }
    </style>
</head>
<body>
    <h1>Cart Options Test</h1>
    
    <div class="cart-display">
        <h3>Cart (<span id="cartCount">0 items</span>)</h3>
        <div>Total: <span id="cartTotal">$0.00</span></div>
        <div id="cartContainer"></div>
    </div>
    
    <div class="product">
        <h2>Test T-Shirt</h2>
        <img src="images/items/placeholder.webp" alt="Test T-Shirt">
        <p>Price: $19.99</p>
        <button onclick="addToCartWithModal('TEST001', 'Test T-Shirt', 19.99, 'images/items/placeholder.webp')">Add to Cart</button>
    </div>
    
    <div class="product">
        <h2>Test Tumbler</h2>
        <img src="images/items/placeholder.webp" alt="Test Tumbler">
        <p>Price: $14.99</p>
        <button onclick="addToCartWithModal('TEST002', 'Test Tumbler', 14.99, 'images/items/placeholder.webp')">Add to Cart</button>
    </div>
    
    <!-- Quantity Modal -->
    <div id="quantityModal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeCartModal()">&times;</span>
            <div class="product-image">
                <img id="modalProductImage" src="" alt="" style="width: 100px; height: 100px; object-fit: cover;">
            </div>
            <h2 id="modalProductName"></h2>
            <p>Unit Price: <span id="modalUnitPrice"></span></p>
            
            <!-- Color and Size options will be inserted here dynamically -->
            
            <div class="quantity-controls">
                <label for="quantityInput">Quantity:</label>
                <button onclick="changeQuantity(-1)">-</button>
                <input type="number" id="quantityInput" value="1" min="1" onchange="updateModalTotal()">
                <button onclick="changeQuantity(1)">+</button>
            </div>
            
            <div>
                <p>Quantity: <span id="modalQuantity">1</span></p>
                <p>Total: <span id="modalTotal">$0.00</span></p>
            </div>
            
            <button onclick="confirmAddToCart()">Add to Cart</button>
        </div>
    </div>
    
    <!-- Custom Alert -->
    <div id="customAlertBox" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #4CAF50; color: white; padding: 20px; border-radius: 5px; z-index: 1001;">
        <span id="customAlertMessage"></span>
    </div>
    
    <script src="js/cart.js"></script>
    <script>
        // Initialize cart
        window.cart = new ShoppingCart();
        
        // Helper function to change quantity
        function changeQuantity(delta) {
            const input = document.getElementById('quantityInput');
            const newValue = Math.max(1, parseInt(input.value) + delta);
            input.value = newValue;
            updateModalTotal();
        }
        
        // Mock API responses for testing
        const originalFetch = window.fetch;
        window.fetch = function(url, options) {
            if (url.includes('/api/item_colors.php')) {
                const urlParams = new URLSearchParams(url.split('?')[1]);
                const itemSku = urlParams.get('item_sku');
                
                if (itemSku === 'TEST001') {
                    // T-Shirt with colors
                    return Promise.resolve({
                        json: () => Promise.resolve({
                            success: true,
                            colors: [
                                { id: 1, color_name: 'Red', color_code: '#FF0000', stock_level: 10 },
                                { id: 2, color_name: 'Blue', color_code: '#0000FF', stock_level: 5 },
                                { id: 3, color_name: 'Green', color_code: '#00FF00', stock_level: 8 }
                            ]
                        })
                    });
                } else {
                    // No colors for other items
                    return Promise.resolve({
                        json: () => Promise.resolve({ success: true, colors: [] })
                    });
                }
            }
            
            if (url.includes('/api/item_sizes.php')) {
                const urlParams = new URLSearchParams(url.split('?')[1]);
                const itemSku = urlParams.get('item_sku');
                const colorId = urlParams.get('color_id');
                
                if (itemSku === 'TEST001') {
                    // T-Shirt with sizes
                    if (colorId === 'null') {
                        // General sizes
                        return Promise.resolve({
                            json: () => Promise.resolve({
                                success: true,
                                sizes: [
                                    { size_name: 'Small', size_code: 'S', stock_level: 10, price_adjustment: 0 },
                                    { size_name: 'Medium', size_code: 'M', stock_level: 15, price_adjustment: 0 },
                                    { size_name: 'Large', size_code: 'L', stock_level: 12, price_adjustment: 0 },
                                    { size_name: 'X-Large', size_code: 'XL', stock_level: 8, price_adjustment: 2.00 },
                                    { size_name: '2X-Large', size_code: '2XL', stock_level: 5, price_adjustment: 4.00 }
                                ]
                            })
                        });
                    }
                } else if (itemSku === 'TEST002') {
                    // Tumbler with different sizes
                    if (colorId === 'null') {
                        return Promise.resolve({
                            json: () => Promise.resolve({
                                success: true,
                                sizes: [
                                    { size_name: '12 oz', size_code: '12OZ', stock_level: 20, price_adjustment: 0 },
                                    { size_name: '16 oz', size_code: '16OZ', stock_level: 15, price_adjustment: 3.00 },
                                    { size_name: '20 oz', size_code: '20OZ', stock_level: 10, price_adjustment: 5.00 }
                                ]
                            })
                        });
                    }
                }
                
                // No sizes for this item/color combination
                return Promise.resolve({
                    json: () => Promise.resolve({ success: true, sizes: [] })
                });
            }
            
            // For all other requests, use original fetch
            return originalFetch.apply(this, arguments);
        };
        
        // Render cart initially
        cart.renderCart();
    </script>
</body>
</html> 